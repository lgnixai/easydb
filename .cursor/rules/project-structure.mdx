# é¡¹ç›®ç»“æ„è§„èŒƒ

## æ ‡å‡†é¡¹ç›®ç»“æ„

```
easydb/
â”œâ”€â”€ .cursor/                    # Cursorè§„åˆ™é…ç½®
â”‚   â””â”€â”€ rules/                  # å¼€å‘è§„èŒƒæ–‡ä»¶
â”œâ”€â”€ cmd/                        # åº”ç”¨ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ server/                 # ä¸»æœåŠ¡å™¨
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â”œâ”€â”€ mcp/                    # MCPæœåŠ¡
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â””â”€â”€ migrate/                # æ•°æ®åº“è¿ç§»å·¥å…·
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ internal/                   # å†…éƒ¨ä»£ç ï¼ˆä¸å¯è¢«å¤–éƒ¨å¯¼å…¥ï¼‰
â”‚   â”œâ”€â”€ domain/                 # é¢†åŸŸå±‚ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”œâ”€â”€ entity/             # å®ä½“
â”‚   â”‚   â”œâ”€â”€ valueobject/        # å€¼å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ aggregate/          # èšåˆ
â”‚   â”‚   â”œâ”€â”€ repository/         # ä»“å‚¨æ¥å£
â”‚   â”‚   â”œâ”€â”€ service/            # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â””â”€â”€ event/              # é¢†åŸŸäº‹ä»¶
â”‚   â”œâ”€â”€ application/            # åº”ç”¨å±‚
â”‚   â”‚   â”œâ”€â”€ command/            # å‘½ä»¤ï¼ˆå†™æ“ä½œï¼‰
â”‚   â”‚   â”œâ”€â”€ query/              # æŸ¥è¯¢ï¼ˆè¯»æ“ä½œï¼‰
â”‚   â”‚   â”œâ”€â”€ service/            # åº”ç”¨æœåŠ¡
â”‚   â”‚   â””â”€â”€ eventhandler/       # äº‹ä»¶å¤„ç†å™¨
â”‚   â”œâ”€â”€ infrastructure/         # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ persistence/        # æŒä¹…åŒ–
â”‚   â”‚   â”œâ”€â”€ cache/              # ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ message/            # æ¶ˆæ¯é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ external/           # å¤–éƒ¨æœåŠ¡
â”‚   â”‚   â””â”€â”€ eventbus/           # äº‹ä»¶æ€»çº¿
â”‚   â”œâ”€â”€ interfaces/             # æ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ http/               # HTTPæ¥å£
â”‚   â”‚   â”œâ”€â”€ grpc/               # gRPCæ¥å£
â”‚   â”‚   â””â”€â”€ mcp/                # MCPåè®®
â”‚   â”œâ”€â”€ container/              # ä¾èµ–æ³¨å…¥å®¹å™¨
â”‚   â”‚   â””â”€â”€ container.go
â”‚   â””â”€â”€ testing/                # æµ‹è¯•è¾…åŠ©
â”‚       â”œâ”€â”€ fixtures/           # æµ‹è¯•å¤¹å…·
â”‚       â””â”€â”€ mocks/              # Mockå¯¹è±¡
â”œâ”€â”€ pkg/                        # å¯è¢«å¤–éƒ¨å¯¼å…¥çš„å…¬å…±åº“
â”‚   â”œâ”€â”€ logger/                 # æ—¥å¿—åº“
â”‚   â”œâ”€â”€ errors/                 # é”™è¯¯å¤„ç†
â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”œâ”€â”€ migrations/                 # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ 000001_init_schema.up.sql
â”‚   â””â”€â”€ 000001_init_schema.down.sql
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/           # æ¶æ„æ–‡æ¡£
â”‚   â””â”€â”€ api/                    # APIæ–‡æ¡£
â”œâ”€â”€ deploy/                     # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ docker/                 # Dockerç›¸å…³
â”‚   â””â”€â”€ kubernetes/             # Kubernetesé…ç½®
â”œâ”€â”€ tests/                      # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ integration/            # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/                    # ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ .gitignore                  # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .golangci.yml              # golangci-linté…ç½®
â”œâ”€â”€ go.mod                      # Goæ¨¡å—å®šä¹‰
â”œâ”€â”€ Makefile                    # Makeå‘½ä»¤
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â””â”€â”€ config.yaml                 # åº”ç”¨é…ç½®ç¤ºä¾‹
```

## ç›®å½•è¯´æ˜

### cmd/ - åº”ç”¨ç¨‹åºå…¥å£
- æ¯ä¸ªå¯æ‰§è¡Œç¨‹åºä¸€ä¸ªå­ç›®å½•
- main.goæ–‡ä»¶ä¿æŒç®€æ´ï¼Œåªè´Ÿè´£åˆå§‹åŒ–å’Œå¯åŠ¨
- ä¸šåŠ¡é€»è¾‘æ”¾åœ¨internal/ç›®å½•

```go
// cmd/server/main.go
package main

func main() {
    // åŠ è½½é…ç½®
    cfg, err := loadConfig()
    if err != nil {
        log.Fatalf("failed to load config: %v", err)
    }
    
    // åˆ›å»ºå®¹å™¨
    c, cleanup, err := container.NewContainer(cfg)
    if err != nil {
        log.Fatalf("failed to create container: %v", err)
    }
    defer cleanup()
    
    // å¯åŠ¨æœåŠ¡å™¨
    if err := c.HTTPServer.Start(ctx); err != nil {
        log.Fatalf("server error: %v", err)
    }
}
```

### internal/ - å†…éƒ¨ä»£ç 
- åªèƒ½è¢«æœ¬é¡¹ç›®å¯¼å…¥ï¼Œä¸èƒ½è¢«å¤–éƒ¨é¡¹ç›®å¯¼å…¥
- æŒ‰DDDåˆ†å±‚ç»„ç»‡ä»£ç 

### pkg/ - å…¬å…±åº“
- å¯ä»¥è¢«å¤–éƒ¨é¡¹ç›®å¯¼å…¥çš„ä»£ç 
- ä¿æŒé€šç”¨æ€§å’Œç‹¬ç«‹æ€§
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘

### migrations/ - æ•°æ®åº“è¿ç§»
- ä½¿ç”¨ç‰ˆæœ¬å·å‘½åï¼š`000001_description.up.sql`
- æ¯ä¸ªè¿ç§»éƒ½æœ‰upå’Œdownä¸¤ä¸ªæ–‡ä»¶
- ä¿æŒè¿ç§»æ–‡ä»¶çš„åŸå­æ€§

## ä¾èµ–æ³¨å…¥å®¹å™¨

```go
// internal/container/container.go
package container

import (
    "database/sql"
)

// Container ä¾èµ–æ³¨å…¥å®¹å™¨
type Container struct {
    // Config
    Config *config.Config
    
    // Infrastructure
    DB     *sql.DB
    Logger logger.Logger
    
    // Repositories
    UserRepository  repository.UserRepository
    
    // Services
    UserService  *service.UserService
    
    // Handlers
    UserHandler  *handler.UserHandler
    
    // Server
    HTTPServer *http.Server
}

// NewContainer åˆ›å»ºå®¹å™¨
func NewContainer(cfg *config.Config) (*Container, func(), error) {
    c := &Container{Config: cfg}
    
    // åˆå§‹åŒ–åŸºç¡€è®¾æ–½
    db, err := initDB(cfg.Database)
    if err != nil {
        return nil, nil, err
    }
    c.DB = db
    
    // åˆå§‹åŒ–ä»“å‚¨
    c.UserRepository = postgres.NewUserRepository(db)
    
    // åˆå§‹åŒ–æœåŠ¡
    c.UserService = service.NewUserService(c.UserRepository)
    
    // åˆå§‹åŒ–å¤„ç†å™¨
    c.UserHandler = handler.NewUserHandler(c.UserService)
    
    // æ¸…ç†å‡½æ•°
    cleanup := func() {
        db.Close()
    }
    
    return c, cleanup, nil
}
```

## Makefileç¤ºä¾‹

```makefile
.PHONY: help build test lint clean run

help: ## æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}'

build: ## æ„å»ºåº”ç”¨
	go build -o bin/server cmd/server/main.go

test: ## è¿è¡Œæµ‹è¯•
	go test -v -cover ./...

lint: ## è¿è¡Œlinter
	golangci-lint run ./...

clean: ## æ¸…ç†æ„å»ºæ–‡ä»¶
	rm -rf bin/

run: ## è¿è¡Œåº”ç”¨
	go run cmd/server/main.go

.DEFAULT_GOAL := help
```

## é…ç½®æ–‡ä»¶ç¤ºä¾‹

```yaml
# config.yaml
server:
  port: 8080
  read_timeout: 30s
  write_timeout: 30s

database:
  host: localhost
  port: 5432
  user: postgres
  password: postgres
  database: easydb

redis:
  host: localhost
  port: 6379

logger:
  level: info
  format: json
```

## README.mdæ¨¡æ¿

```markdown
# EasyDB

ç®€çŸ­çš„é¡¹ç›®æè¿°

## ç‰¹æ€§

- ğŸ—ï¸ é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰æ¶æ„
- ğŸ”’ JWTè®¤è¯å’Œæˆæƒ
- ğŸ“Š RESTful API
- ğŸ—„ï¸ PostgreSQLæ•°æ®åº“

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Go 1.21+
- PostgreSQL 14+
- Redis 7+

### å®‰è£…

\`\`\`bash
git clone https://github.com/yourorg/easydb.git
cd easydb
go mod download
make migrate-up
make run
\`\`\`

## æµ‹è¯•

\`\`\`bash
make test
make test-coverage
\`\`\`

## è®¸å¯è¯

[MIT License](LICENSE)
```

## æœ€ä½³å®è·µ

1. **ä¿æŒç»“æ„æ¸…æ™°**ï¼šéµå¾ªæ ‡å‡†Goé¡¹ç›®ç»“æ„
2. **æŒ‰åŠŸèƒ½ç»„ç»‡**ï¼šinternalæŒ‰DDDåˆ†å±‚ï¼ŒpkgæŒ‰åŠŸèƒ½
3. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªåŒ…æœ‰æ˜ç¡®çš„èŒè´£
4. **é¿å…å¾ªç¯ä¾èµ–**ï¼šåˆç†è§„åˆ’åŒ…ä¾èµ–å…³ç³»
5. **æ–‡æ¡£é½å…¨**ï¼šREADMEã€æ¶æ„æ–‡æ¡£ã€APIæ–‡æ¡£
6. **è‡ªåŠ¨åŒ–**ï¼šä½¿ç”¨Makefileç®€åŒ–å¸¸ç”¨å‘½ä»¤
7. **ç‰ˆæœ¬æ§åˆ¶**ï¼šåˆç†çš„.gitignoreé…ç½®
8. **é…ç½®ç®¡ç†**ï¼šé…ç½®ä¸ä»£ç åˆ†ç¦»
