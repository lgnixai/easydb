# AI 侧边栏使用指南

## 简介

AI 侧边栏是一个基于 Ollama 模型的智能助手，可以通过自然语言帮助你管理数据库、表格、字段等操作。

## 功能特性

### 支持的操作

1. **空间管理**
   - 创建新空间
   - 查询空间信息

2. **数据库管理**
   - 创建数据库
   - 查询数据库信息
   - 列出所有数据库

3. **表格管理**
   - 创建表格
   - 列出表格
   - 查询表格详情

4. **字段管理**
   - 创建字段（支持多种类型）
   - 查询字段信息
   - 支持的字段类型：
     - text（文本）
     - number（数字）
     - select（单选）
     - date（日期）
     - email（邮箱）
     - checkbox（复选框）
     - url（链接）
     - phone（电话）

5. **记录管理**
   - 创建记录
   - 批量导入

## 安装配置

### 1. 安装 Ollama

访问 [Ollama 官网](https://ollama.ai) 下载并安装。

```bash
# macOS/Linux
curl -fsSL https://ollama.ai/install.sh | sh

# 启动 Ollama 服务
ollama serve
```

### 2. 下载模型

```bash
# 推荐使用 llama3.2（较小，速度快）
ollama pull llama3.2

# 或使用其他模型
ollama pull llama2
ollama pull mistral
ollama pull qwen2
```

### 3. 配置环境变量

在项目根目录创建 `.env` 文件：

```env
VITE_OLLAMA_URL=http://localhost:11434
VITE_OLLAMA_MODEL=llama3.2
VITE_ENABLE_AI_SIDEBAR=true
```

### 4. 启动项目

```bash
cd teable-ui
pnpm install
pnpm dev
```

## 使用方法

### 基础对话

1. 在右侧边栏的输入框中输入你的需求
2. AI 会解析你的意图并给出回复
3. 如果需要执行操作，AI 会询问确认
4. 点击"确认"执行操作，或点击"取消"放弃

### 示例命令

#### 创建空间

```
创建一个名为"公司管理"的空间
```

```
新建空间：项目管理系统
```

#### 创建数据库

```
在当前空间创建一个数据库，名称为"人事管理"
```

```
创建数据库：客户关系管理
```

#### 创建表格

```
创建一个员工信息表
```

```
帮我创建一个表格叫"产品目录"
```

#### 创建字段

单个字段：
```
添加一个姓名字段
```

```
创建一个邮箱字段，类型是email
```

多个字段：
```
添加以下字段：姓名（文本）、年龄（数字）、邮箱（邮箱）
```

```
给当前表添加字段：部门（单选）、入职日期（日期）、是否在职（复选框）
```

#### 查询信息

```
列出当前数据库的所有表格
```

```
显示当前数据库信息
```

### 上下文理解

AI 会自动识别当前选中的：
- **空间**：在顶部栏选择
- **数据库**：在左侧栏选择
- **表格**：打开的表格标签

当你说"创建表格"时，AI 会自动在当前选中的数据库中创建。

### 操作确认

对于重要操作（如创建、删除），AI 会要求确认：

```
用户: 创建一个员工表
AI: 我将在当前数据库中创建表格'员工表'，是否继续？
    [确认] [取消]
```

点击"确认"后执行，点击"取消"则放弃操作。

### 查看结果

操作完成后，AI 会显示结果：

- ✅ 成功：绿色提示，显示操作结果
- ❌ 失败：红色提示，显示错误信息
- ⏳ 执行中：蓝色提示，显示进度

## 高级技巧

### 1. 批量操作

一次创建多个字段：
```
创建以下字段：
1. 姓名（文本，必填）
2. 邮箱（邮箱，必填，唯一）
3. 电话（电话）
4. 地址（文本）
```

### 2. 指定参数

```
创建一个名为"用户ID"的字段，类型是文本，必填且唯一
```

```
添加一个"创建时间"字段，类型是日期，默认值是当前时间
```

### 3. 清空历史

点击右上角的垃圾桶图标可以清空聊天历史。

### 4. 快捷键

- `Enter`：发送消息
- `Shift + Enter`：换行

## 常见问题

### Q: AI 无响应或报错

**A:** 检查以下几点：

1. 确认 Ollama 服务正在运行：
   ```bash
   # 检查服务状态
   curl http://localhost:11434/api/tags
   ```

2. 确认模型已下载：
   ```bash
   ollama list
   ```

3. 检查环境变量配置是否正确

### Q: AI 理解不了我的意图

**A:** 尝试以下方法：

1. 使用更明确的表达，例如：
   - ❌ "加个字段"
   - ✅ "创建一个姓名字段"

2. 指定字段类型：
   - ❌ "添加邮箱"
   - ✅ "添加一个邮箱字段，类型是email"

3. 分步骤执行复杂操作

### Q: 操作失败怎么办

**A:** AI 会显示错误信息，常见原因：

1. 未选择空间/数据库/表格
2. 名称重复
3. 权限不足
4. 参数格式错误

根据错误提示调整后重试。

### Q: 如何更换模型

**A:** 修改 `.env` 文件：

```env
VITE_OLLAMA_MODEL=llama3.1  # 更换为其他模型
```

然后重启开发服务器。

推荐模型：
- `llama3.2`：轻量快速（推荐）
- `llama3.1`：功能强大
- `qwen2`：中文优化
- `mistral`：平衡性能

### Q: 能否使用其他 AI 服务

**A:** 当前仅支持 Ollama。未来版本可能支持：
- OpenAI API
- Claude API
- 本地其他模型

## 最佳实践

1. **明确指定操作对象**
   ```
   在"项目管理"数据库中创建一个"任务"表
   ```

2. **提供完整信息**
   ```
   创建字段：任务名称（文本类型，必填）
   ```

3. **分步执行复杂任务**
   - 先创建表格
   - 再添加字段
   - 最后创建记录

4. **善用上下文**
   - 先选择好空间、数据库、表格
   - 然后直接说"创建字段"即可

5. **定期清理历史**
   - 避免对话历史过长影响性能
   - 开始新任务前清空历史

## 反馈和改进

如果你有任何建议或发现问题，欢迎反馈！

## 更新日志

### v1.0.0 (2025-10-08)

- ✅ 基础对话功能
- ✅ 创建空间、数据库、表格、字段
- ✅ 操作确认机制
- ✅ 上下文识别
- ✅ 错误处理
- ✅ 聊天历史管理

### 计划功能

- [ ] 语音输入
- [ ] 对话历史导出
- [ ] 自定义模板
- [ ] 批量操作优化
- [ ] 更智能的意图识别
- [ ] 支持删除和更新操作
- [ ] 数据可视化建议

